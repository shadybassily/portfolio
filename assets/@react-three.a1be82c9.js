import{r as T}from"./react.ef76592b.js";import{T as ge,R as Ye,O as Ke,P as Je,a as le,L as ce,b as Qe,c as Ze,U as et,s as Te,B as tt,M as nt,W as rt,C as ot,d as it,e as st,V as at,f as lt,N as ct,A as ut,g as Oe,h as te,i as ft,S as dt,j as pt,k as vt,D as mt}from"./three.50342b97.js";import{u as ht}from"./react-use-measure.e3e12096.js";import{F as gt,u as yt}from"./its-fine.b0cdc51c.js";import{R as _t,c as Y}from"./react-reconciler.99af5c73.js";import{j as F,a as Re}from"./@react-spring.6db65d6f.js";import"./react-dom.ba6306c3.js";import{s as je,p as wt,c as bt}from"./suspend-react.32e71e37.js";import{T as Ct,m as Pt,F as Et,O as xt}from"./three-stdlib.7d6856f3.js";import{m as Mt}from"./react-merge-refs.1793fef1.js";import{c as St}from"./zustand.5deef552.js";var ye={exports:{}},Ae={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(h,P){var E=h.length;h.push(P);e:for(;0<E;){var M=E-1>>>1,A=h[M];if(0<u(A,P))h[M]=P,h[E]=A,E=M;else break e}}function o(h){return h.length===0?null:h[0]}function s(h){if(h.length===0)return null;var P=h[0],E=h.pop();if(E!==P){h[0]=E;e:for(var M=0,A=h.length,I=A>>>1;M<I;){var H=2*(M+1)-1,J=h[H],$=H+1,re=h[$];if(0>u(J,E))$<A&&0>u(re,J)?(h[M]=re,h[$]=E,M=$):(h[M]=J,h[H]=E,M=H);else if($<A&&0>u(re,E))h[M]=re,h[$]=E,M=$;else break e}}return P}function u(h,P){var E=h.sortIndex-P.sortIndex;return E!==0?E:h.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var v=performance;e.unstable_now=function(){return v.now()}}else{var b=Date,m=b.now();e.unstable_now=function(){return b.now()-m}}var i=[],p=[],n=1,r=null,l=3,d=!1,f=!1,_=!1,y=typeof setTimeout=="function"?setTimeout:null,a=typeof clearTimeout=="function"?clearTimeout:null,c=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(h){for(var P=o(p);P!==null;){if(P.callback===null)s(p);else if(P.startTime<=h)s(p),P.sortIndex=P.expirationTime,t(i,P);else break;P=o(p)}}function w(h){if(_=!1,g(h),!f)if(o(i)!==null)f=!0,U(C);else{var P=o(p);P!==null&&z(w,P.startTime-h)}}function C(h,P){f=!1,_&&(_=!1,a(j),j=-1),d=!0;var E=l;try{for(g(P),r=o(i);r!==null&&(!(r.expirationTime>P)||h&&!O());){var M=r.callback;if(typeof M=="function"){r.callback=null,l=r.priorityLevel;var A=M(r.expirationTime<=P);P=e.unstable_now(),typeof A=="function"?r.callback=A:r===o(i)&&s(i),g(P)}else s(i);r=o(i)}if(r!==null)var I=!0;else{var H=o(p);H!==null&&z(w,H.startTime-P),I=!1}return I}finally{r=null,l=E,d=!1}}var k=!1,R=null,j=-1,S=5,x=-1;function O(){return!(e.unstable_now()-x<S)}function L(){if(R!==null){var h=e.unstable_now();x=h;var P=!0;try{P=R(!0,h)}finally{P?B():(k=!1,R=null)}}else k=!1}var B;if(typeof c=="function")B=function(){c(L)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,G=N.port2;N.port1.onmessage=L,B=function(){G.postMessage(null)}}else B=function(){y(L,0)};function U(h){R=h,k||(k=!0,B())}function z(h,P){j=y(function(){h(e.unstable_now())},P)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(h){h.callback=null},e.unstable_continueExecution=function(){f||d||(f=!0,U(C))},e.unstable_forceFrameRate=function(h){0>h||125<h?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<h?Math.floor(1e3/h):5},e.unstable_getCurrentPriorityLevel=function(){return l},e.unstable_getFirstCallbackNode=function(){return o(i)},e.unstable_next=function(h){switch(l){case 1:case 2:case 3:var P=3;break;default:P=l}var E=l;l=P;try{return h()}finally{l=E}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(h,P){switch(h){case 1:case 2:case 3:case 4:case 5:break;default:h=3}var E=l;l=h;try{return P()}finally{l=E}},e.unstable_scheduleCallback=function(h,P,E){var M=e.unstable_now();switch(typeof E=="object"&&E!==null?(E=E.delay,E=typeof E=="number"&&0<E?M+E:M):E=M,h){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=E+A,h={id:n++,callback:P,priorityLevel:h,startTime:E,expirationTime:A,sortIndex:-1},E>M?(h.sortIndex=E,t(p,h),o(i)===null&&h===o(p)&&(_?(a(j),j=-1):_=!0,z(w,E-M))):(h.sortIndex=A,t(i,h),f||d||(f=!0,U(C))),h},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(h){var P=l;return function(){var E=l;l=P;try{return h.apply(this,arguments)}finally{l=E}}}})(Ae);(function(e){e.exports=Ae})(ye);var Ce,Pe;const kt=(e,...t)=>t.reduce((o,s)=>o==null?void 0:o[s],e),W="ColorManagement"in ge&&kt(ge,"ColorManagement")||null,De=e=>e&&e.isOrthographicCamera,Tt=e=>e&&e.hasOwnProperty("current"),ne=typeof window<"u"&&((Ce=window.document)!=null&&Ce.createElement||((Pe=window.navigator)==null?void 0:Pe.product)==="ReactNative")?T.exports.useLayoutEffect:T.exports.useEffect;function Le(e){const t=T.exports.useRef(e);return ne(()=>void(t.current=e),[e]),t}function Ot({set:e}){return ne(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class Fe extends T.exports.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}}Fe.getDerivedStateFromError=()=>({error:!0});const Ie="__default",Ee=new Map,Rt=e=>e&&!!e.memoized&&!!e.changes;function ze(e){const t=typeof window<"u"?window.devicePixelRatio:1;return Array.isArray(e)?Math.min(Math.max(e[0],t),e[1]):e}const Q=e=>{var t;return(t=e.__r3f)==null?void 0:t.root.getState()},D={obj:e=>e===Object(e)&&!D.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,t,{arrays:o="shallow",objects:s="reference",strict:u=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(D.str(e)||D.num(e))return e===t;const v=D.obj(e);if(v&&s==="reference")return e===t;const b=D.arr(e);if(b&&o==="reference")return e===t;if((b||v)&&e===t)return!0;let m;for(m in e)if(!(m in t))return!1;for(m in u?t:e)if(e[m]!==t[m])return!1;if(D.und(m)){if(b&&e.length===0&&t.length===0||v&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function jt(e){const t={nodes:{},materials:{}};return e&&e.traverse(o=>{o.name&&(t.nodes[o.name]=o),o.material&&!t.materials[o.material.name]&&(t.materials[o.material.name]=o.material)}),t}function At(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const t in e)t.dispose==null||t.dispose(),delete e[t]}function V(e,t){const o=e;return(t!=null&&t.primitive||!o.__r3f)&&(o.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t}),e}function _e(e,t){let o=e;if(t.includes("-")){const s=t.split("-"),u=s.pop();return o=s.reduce((v,b)=>v[b],e),{target:o,key:u}}else return{target:o,key:t}}const xe=/-\d+$/;function ue(e,t,o){if(D.str(o)){if(xe.test(o)){const v=o.replace(xe,""),{target:b,key:m}=_e(e,v);Array.isArray(b[m])||(b[m]=[])}const{target:s,key:u}=_e(e,o);t.__r3f.previousAttach=s[u],s[u]=t}else t.__r3f.previousAttach=o(e,t)}function Me(e,t,o){var s,u;if(D.str(o)){const{target:v,key:b}=_e(e,o),m=t.__r3f.previousAttach;m===void 0?delete v[b]:v[b]=m}else(s=t.__r3f)==null||s.previousAttach==null||s.previousAttach(e,t);(u=t.__r3f)==null||delete u.previousAttach}function Be(e,{children:t,key:o,ref:s,...u},{children:v,key:b,ref:m,...i}={},p=!1){var n;const r=(n=e==null?void 0:e.__r3f)!=null?n:{},l=Object.entries(u),d=[];if(p){const _=Object.keys(i);for(let y=0;y<_.length;y++)u.hasOwnProperty(_[y])||l.unshift([_[y],Ie+"remove"])}l.forEach(([_,y])=>{var a;if((a=e.__r3f)!=null&&a.primitive&&_==="object"||D.equ(y,i[_]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(_))return d.push([_,y,!0,[]]);let c=[];_.includes("-")&&(c=_.split("-")),d.push([_,y,!1,c]);for(const g in u){const w=u[g];g.startsWith(`${_}-`)&&d.push([g,w,!1,g.split("-")])}});const f={...u};return r.memoizedProps&&r.memoizedProps.args&&(f.args=r.memoizedProps.args),r.memoizedProps&&r.memoizedProps.attach&&(f.attach=r.memoizedProps.attach),{memoized:f,changes:d}}function fe(e,t){var o,s,u;const v=(o=e.__r3f)!=null?o:{},b=v.root,m=(s=b==null||b.getState==null?void 0:b.getState())!=null?s:{},{memoized:i,changes:p}=Rt(t)?t:Be(e,t),n=v.eventCount;e.__r3f&&(e.__r3f.memoizedProps=i);for(let l=0;l<p.length;l++){let[d,f,_,y]=p[l],a=e,c=a[d];if(y.length&&(c=y.reduce((g,w)=>g[w],e),!(c&&c.set))){const[g,...w]=y.reverse();a=w.reverse().reduce((C,k)=>C[k],e),d=g}if(f===Ie+"remove")if(a.constructor){let g=Ee.get(a.constructor);g||(g=new a.constructor,Ee.set(a.constructor,g)),f=g[d]}else f=0;if(_)f?v.handlers[d]=f:delete v.handlers[d],v.eventCount=Object.keys(v.handlers).length;else if(c&&c.set&&(c.copy||c instanceof ce)){if(Array.isArray(f))c.fromArray?c.fromArray(f):c.set(...f);else if(c.copy&&f&&f.constructor&&c.constructor===f.constructor)c.copy(f);else if(f!==void 0){const g=c instanceof Oe;!g&&c.setScalar?c.setScalar(f):c instanceof ce&&f instanceof ce?c.mask=f.mask:c.set(f),!W&&!m.linear&&g&&c.convertSRGBToLinear()}}else a[d]=f,!m.linear&&a[d]instanceof Qe&&a[d].format===Ze&&a[d].type===et&&(a[d].encoding=Te);X(e)}if(v.parent&&m.internal&&e.raycast&&n!==v.eventCount){const l=m.internal.interaction.indexOf(e);l>-1&&m.internal.interaction.splice(l,1),v.eventCount&&m.internal.interaction.push(e)}return!(p.length===1&&p[0][0]==="onUpdate")&&p.length&&(u=e.__r3f)!=null&&u.parent&&we(e),e}function X(e){var t,o;const s=(t=e.__r3f)==null||(o=t.root)==null||o.getState==null?void 0:o.getState();s&&s.internal.frames===0&&s.invalidate()}function we(e){e.onUpdate==null||e.onUpdate(e)}function Dt(e,t){e.manual||(De(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function oe(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Lt(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return Y.exports.DefaultEventPriority;switch((e=t.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Y.exports.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Y.exports.ContinuousEventPriority;default:return Y.exports.DefaultEventPriority}}function He(e,t,o,s){const u=o.get(t);u&&(o.delete(t),o.size===0&&(e.delete(s),u.target.releasePointerCapture(s)))}function Ft(e,t){const{internal:o}=e.getState();o.interaction=o.interaction.filter(s=>s!==t),o.initialHits=o.initialHits.filter(s=>s!==t),o.hovered.forEach((s,u)=>{(s.eventObject===t||s.object===t)&&o.hovered.delete(u)}),o.capturedMap.forEach((s,u)=>{He(o.capturedMap,t,s,u)})}function It(e){function t(i){const{internal:p}=e.getState(),n=i.offsetX-p.initialClick[0],r=i.offsetY-p.initialClick[1];return Math.round(Math.sqrt(n*n+r*r))}function o(i){return i.filter(p=>["Move","Over","Enter","Out","Leave"].some(n=>{var r;return(r=p.__r3f)==null?void 0:r.handlers["onPointer"+n]}))}function s(i,p){const n=e.getState(),r=new Set,l=[],d=p?p(n.internal.interaction):n.internal.interaction;for(let a=0;a<d.length;a++){const c=Q(d[a]);c&&(c.raycaster.camera=void 0)}n.previousRoot||n.events.compute==null||n.events.compute(i,n);function f(a){const c=Q(a);if(!c||!c.events.enabled||c.raycaster.camera===null)return[];if(c.raycaster.camera===void 0){var g;c.events.compute==null||c.events.compute(i,c,(g=c.previousRoot)==null?void 0:g.getState()),c.raycaster.camera===void 0&&(c.raycaster.camera=null)}return c.raycaster.camera?c.raycaster.intersectObject(a,!0):[]}let _=d.flatMap(f).sort((a,c)=>{const g=Q(a.object),w=Q(c.object);return!g||!w?a.distance-c.distance:w.events.priority-g.events.priority||a.distance-c.distance}).filter(a=>{const c=oe(a);return r.has(c)?!1:(r.add(c),!0)});n.events.filter&&(_=n.events.filter(_,n));for(const a of _){let c=a.object;for(;c;){var y;(y=c.__r3f)!=null&&y.eventCount&&l.push({...a,eventObject:c}),c=c.parent}}if("pointerId"in i&&n.internal.capturedMap.has(i.pointerId))for(let a of n.internal.capturedMap.get(i.pointerId).values())r.has(oe(a.intersection))||l.push(a.intersection);return l}function u(i,p,n,r){const l=e.getState();if(i.length){const d={stopped:!1};for(const f of i){const _=Q(f.object)||l,{raycaster:y,pointer:a,camera:c,internal:g}=_,w=new te(a.x,a.y,0).unproject(c),C=x=>{var O,L;return(O=(L=g.capturedMap.get(x))==null?void 0:L.has(f.eventObject))!=null?O:!1},k=x=>{const O={intersection:f,target:p.target};g.capturedMap.has(x)?g.capturedMap.get(x).set(f.eventObject,O):g.capturedMap.set(x,new Map([[f.eventObject,O]])),p.target.setPointerCapture(x)},R=x=>{const O=g.capturedMap.get(x);O&&He(g.capturedMap,f.eventObject,O,x)};let j={};for(let x in p){let O=p[x];typeof O!="function"&&(j[x]=O)}let S={...f,...j,pointer:a,intersections:i,stopped:d.stopped,delta:n,unprojectedPoint:w,ray:y.ray,camera:c,stopPropagation(){const x="pointerId"in p&&g.capturedMap.get(p.pointerId);if((!x||x.has(f.eventObject))&&(S.stopped=d.stopped=!0,g.hovered.size&&Array.from(g.hovered.values()).find(O=>O.eventObject===f.eventObject))){const O=i.slice(0,i.indexOf(f));v([...O,f])}},target:{hasPointerCapture:C,setPointerCapture:k,releasePointerCapture:R},currentTarget:{hasPointerCapture:C,setPointerCapture:k,releasePointerCapture:R},nativeEvent:p};if(r(S),d.stopped===!0)break}}return i}function v(i){const{internal:p}=e.getState();for(const n of p.hovered.values())if(!i.length||!i.find(r=>r.object===n.object&&r.index===n.index&&r.instanceId===n.instanceId)){const l=n.eventObject.__r3f,d=l==null?void 0:l.handlers;if(p.hovered.delete(oe(n)),l!=null&&l.eventCount){const f={...n,intersections:i};d.onPointerOut==null||d.onPointerOut(f),d.onPointerLeave==null||d.onPointerLeave(f)}}}function b(i,p){for(let n=0;n<p.length;n++){const r=p[n].__r3f;r==null||r.handlers.onPointerMissed==null||r.handlers.onPointerMissed(i)}}function m(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>v([]);case"onLostPointerCapture":return p=>{const{internal:n}=e.getState();"pointerId"in p&&n.capturedMap.has(p.pointerId)&&(n.capturedMap.delete(p.pointerId),v([]))}}return function(n){const{onPointerMissed:r,internal:l}=e.getState();l.lastEvent.current=n;const d=i==="onPointerMove",f=i==="onClick"||i==="onContextMenu"||i==="onDoubleClick",y=s(n,d?o:void 0),a=f?t(n):0;i==="onPointerDown"&&(l.initialClick=[n.offsetX,n.offsetY],l.initialHits=y.map(g=>g.eventObject)),f&&!y.length&&a<=2&&(b(n,l.interaction),r&&r(n)),d&&v(y);function c(g){const w=g.eventObject,C=w.__r3f,k=C==null?void 0:C.handlers;if(!!(C!=null&&C.eventCount))if(d){if(k.onPointerOver||k.onPointerEnter||k.onPointerOut||k.onPointerLeave){const R=oe(g),j=l.hovered.get(R);j?j.stopped&&g.stopPropagation():(l.hovered.set(R,g),k.onPointerOver==null||k.onPointerOver(g),k.onPointerEnter==null||k.onPointerEnter(g))}k.onPointerMove==null||k.onPointerMove(g)}else{const R=k[i];R?(!f||l.initialHits.includes(w))&&(b(n,l.interaction.filter(j=>!l.initialHits.includes(j))),R(g)):f&&l.initialHits.includes(w)&&b(n,l.interaction.filter(j=>!l.initialHits.includes(j)))}}u(y,n,a,c)}}return{handlePointer:m}}let be={},Ne=e=>void(be={...be,...e});function zt(e,t){function o(n,{args:r=[],attach:l,...d},f){let _=`${n[0].toUpperCase()}${n.slice(1)}`,y;if(n==="primitive"){if(d.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const a=d.object;y=V(a,{type:n,root:f,attach:l,primitive:!0})}else{const a=be[_];if(!a)throw new Error(`R3F: ${_} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(r))throw new Error("R3F: The args prop must be an array!");y=V(new a(...r),{type:n,root:f,attach:l,memoizedProps:{args:r}})}return y.__r3f.attach===void 0&&(y instanceof tt?y.__r3f.attach="geometry":y instanceof nt&&(y.__r3f.attach="material")),_!=="inject"&&fe(y,d),y}function s(n,r){let l=!1;if(r){var d,f;(d=r.__r3f)!=null&&d.attach?ue(n,r,r.__r3f.attach):r.isObject3D&&n.isObject3D&&(n.add(r),l=!0),l||(f=n.__r3f)==null||f.objects.push(r),r.__r3f||V(r,{}),r.__r3f.parent=n,we(r),X(r)}}function u(n,r,l){let d=!1;if(r){var f,_;if((f=r.__r3f)!=null&&f.attach)ue(n,r,r.__r3f.attach);else if(r.isObject3D&&n.isObject3D){r.parent=n,r.dispatchEvent({type:"added"});const y=n.children.filter(c=>c!==r),a=y.indexOf(l);n.children=[...y.slice(0,a),r,...y.slice(a)],d=!0}d||(_=n.__r3f)==null||_.objects.push(r),r.__r3f||V(r,{}),r.__r3f.parent=n,we(r),X(r)}}function v(n,r,l=!1){n&&[...n].forEach(d=>b(r,d,l))}function b(n,r,l){if(r){var d,f,_;if(r.__r3f&&(r.__r3f.parent=null),(d=n.__r3f)!=null&&d.objects&&(n.__r3f.objects=n.__r3f.objects.filter(w=>w!==r)),(f=r.__r3f)!=null&&f.attach)Me(n,r,r.__r3f.attach);else if(r.isObject3D&&n.isObject3D){var y;n.remove(r),(y=r.__r3f)!=null&&y.root&&Ft(r.__r3f.root,r)}const c=(_=r.__r3f)==null?void 0:_.primitive,g=l===void 0?r.dispose!==null&&!c:l;if(!c){var a;v((a=r.__r3f)==null?void 0:a.objects,r,g),v(r.children,r,g)}r.__r3f&&(delete r.__r3f.root,delete r.__r3f.objects,delete r.__r3f.handlers,delete r.__r3f.memoizedProps,c||delete r.__r3f),g&&r.dispose&&r.type!=="Scene"&&ye.exports.unstable_scheduleCallback(ye.exports.unstable_IdlePriority,()=>{try{r.dispose()}catch{}}),X(n)}}function m(n,r,l,d){var f;const _=(f=n.__r3f)==null?void 0:f.parent;if(!_)return;const y=o(r,l,n.__r3f.root);if(n.children){for(const a of n.children)a.__r3f&&s(y,a);n.children=n.children.filter(a=>!a.__r3f)}n.__r3f.objects.forEach(a=>s(y,a)),n.__r3f.objects=[],n.__r3f.autoRemovedBeforeAppend||b(_,n),y.parent&&(y.__r3f.autoRemovedBeforeAppend=!0),s(_,y),y.raycast&&y.__r3f.eventCount&&y.__r3f.root.getState().internal.interaction.push(y),[d,d.alternate].forEach(a=>{a!==null&&(a.stateNode=y,a.ref&&(typeof a.ref=="function"?a.ref(y):a.ref.current=y))})}const i=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:_t({createInstance:o,removeChild:b,appendChild:s,appendInitialChild:s,insertBefore:u,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(n,r)=>{if(!r)return;const l=n.getState().scene;!l.__r3f||(l.__r3f.root=n,s(l,r))},removeChildFromContainer:(n,r)=>{!r||b(n.getState().scene,r)},insertInContainerBefore:(n,r,l)=>{if(!r||!l)return;const d=n.getState().scene;!d.__r3f||u(d,r,l)},getRootHostContext:()=>null,getChildHostContext:n=>n,finalizeInitialChildren(n){var r;const l=(r=n==null?void 0:n.__r3f)!=null?r:{};return Boolean(l.handlers)},prepareUpdate(n,r,l,d){if(n.__r3f.primitive&&d.object&&d.object!==n)return[!0];{const{args:f=[],children:_,...y}=d,{args:a=[],children:c,...g}=l;if(!Array.isArray(f))throw new Error("R3F: the args prop must be an array!");if(f.some((C,k)=>C!==a[k]))return[!0];const w=Be(n,y,g,!0);return w.changes.length?[!1,w]:null}},commitUpdate(n,[r,l],d,f,_,y){r?m(n,d,_,y):fe(n,l)},commitMount(n,r,l,d){var f;const _=(f=n.__r3f)!=null?f:{};n.raycast&&_.handlers&&_.eventCount&&n.__r3f.root.getState().internal.interaction.push(n)},getPublicInstance:n=>n,prepareForCommit:()=>null,preparePortalMount:n=>V(n.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(n){var r;const{attach:l,parent:d}=(r=n.__r3f)!=null?r:{};l&&d&&Me(d,n,l),n.isObject3D&&(n.visible=!1),X(n)},unhideInstance(n,r){var l;const{attach:d,parent:f}=(l=n.__r3f)!=null?l:{};d&&f&&ue(f,n,d),(n.isObject3D&&r.visible==null||r.visible)&&(n.visible=!0),X(n)},createTextInstance:i,hideTextInstance:i,unhideTextInstance:i,getCurrentEventPriority:()=>t?t():Y.exports.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&D.fun(performance.now)?performance.now:D.fun(Date.now)?Date.now:()=>0,scheduleTimeout:D.fun(setTimeout)?setTimeout:void 0,cancelTimeout:D.fun(clearTimeout)?clearTimeout:void 0}),applyProps:fe}}const Ue=e=>!!(e!=null&&e.render),qe=T.exports.createContext(null),Bt=(e,t)=>{const o=St((m,i)=>{const p=new te,n=new te,r=new te;function l(a=i().camera,c=n,g=i().size){const{width:w,height:C,top:k,left:R}=g,j=w/C;c instanceof te?r.copy(c):r.set(...c);const S=a.getWorldPosition(p).distanceTo(r);if(De(a))return{width:w/a.zoom,height:C/a.zoom,top:k,left:R,factor:1,distance:S,aspect:j};{const x=a.fov*Math.PI/180,O=2*Math.tan(x/2)*S,L=O*(w/C);return{width:L,height:O,top:k,left:R,factor:w/L,distance:S,aspect:j}}}let d;const f=a=>m(c=>({performance:{...c.performance,current:a}})),_=new ft;return{set:m,get:i,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,invalidate:(a=1)=>e(i(),a),advance:(a,c)=>t(a,c,i()),legacy:!1,linear:!1,flat:!1,scene:V(new dt),controls:null,clock:new pt,pointer:_,mouse:_,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const a=i();d&&clearTimeout(d),a.performance.current!==a.performance.min&&f(a.performance.min),d=setTimeout(()=>f(i().performance.max),a.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:a=>m(c=>({...c,events:{...c.events,...a}})),setSize:(a,c,g,w,C)=>{const k=i().camera,R={width:a,height:c,top:w||0,left:C||0,updateStyle:g};m(j=>({size:R,viewport:{...j.viewport,...l(k,n,R)}}))},setDpr:a=>m(c=>{const g=ze(a);return{viewport:{...c.viewport,dpr:g,initialDpr:c.viewport.initialDpr||g}}}),setFrameloop:(a="always")=>{const c=i().clock;c.stop(),c.elapsedTime=0,a!=="never"&&(c.start(),c.elapsedTime=0),m(()=>({frameloop:a}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:T.exports.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(a,c,g)=>{const w=i().internal;return w.priority=w.priority+(c>0?1:0),w.subscribers.push({ref:a,priority:c,store:g}),w.subscribers=w.subscribers.sort((C,k)=>C.priority-k.priority),()=>{const C=i().internal;C!=null&&C.subscribers&&(C.priority=C.priority-(c>0?1:0),C.subscribers=C.subscribers.filter(k=>k.ref!==a))}}}}}),s=o.getState();let u=s.size,v=s.viewport.dpr,b=s.camera;return o.subscribe(()=>{const{camera:m,size:i,viewport:p,gl:n,set:r}=o.getState();if(i!==u||p.dpr!==v){var l;u=i,v=p.dpr,Dt(m,i),n.setPixelRatio(p.dpr);const d=(l=i.updateStyle)!=null?l:typeof HTMLCanvasElement<"u"&&n.domElement instanceof HTMLCanvasElement;n.setSize(i.width,i.height,d)}m!==b&&(b=m,r(d=>({viewport:{...d.viewport,...d.viewport.getCurrentViewport(m)}})))}),o.subscribe(m=>e(m)),o};let ie,Ht=new Set,Nt=new Set,Ut=new Set;function de(e,t){if(!!e.size)for(const{callback:o}of e.values())o(t)}function Z(e,t){switch(e){case"before":return de(Ht,t);case"after":return de(Nt,t);case"tail":return de(Ut,t)}}let pe,ve;function me(e,t,o){let s=t.clock.getDelta();for(t.frameloop==="never"&&typeof e=="number"&&(s=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),pe=t.internal.subscribers,ie=0;ie<pe.length;ie++)ve=pe[ie],ve.ref.current(ve.store.getState(),s,o);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}function qt(e){let t=!1,o,s,u;function v(i){s=requestAnimationFrame(v),t=!0,o=0,Z("before",i);for(const n of e.values()){var p;u=n.store.getState(),u.internal.active&&(u.frameloop==="always"||u.internal.frames>0)&&!((p=u.gl.xr)!=null&&p.isPresenting)&&(o+=me(i,u))}if(Z("after",i),o===0)return Z("tail",i),t=!1,cancelAnimationFrame(s)}function b(i,p=1){var n;if(!i)return e.forEach(r=>b(r.store.getState()),p);(n=i.gl.xr)!=null&&n.isPresenting||!i.internal.active||i.frameloop==="never"||(i.internal.frames=Math.min(60,i.internal.frames+p),t||(t=!0,requestAnimationFrame(v)))}function m(i,p=!0,n,r){if(p&&Z("before",i),n)me(i,n,r);else for(const l of e.values())me(i,l.store.getState());p&&Z("after",i)}return{loop:v,invalidate:b,advance:m}}function Ge(){const e=T.exports.useContext(qe);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function q(e=o=>o,t){return Ge()(e,t)}function $e(e,t=0){const o=Ge(),s=o.getState().internal.subscribe,u=Le(e);return ne(()=>s(u,t,o),[t,s,o]),null}function We(e,t){return function(o,...s){const u=new o;return e&&e(u),Promise.all(s.map(v=>new Promise((b,m)=>u.load(v,i=>{i.scene&&Object.assign(i,jt(i.scene)),b(i)},t,i=>m(new Error(`Could not load ${v}: ${i.message})`))))))}}function Ve(e,t,o,s){const u=Array.isArray(t)?t:[t],v=je(We(o,s),[e,...u],{equal:D.equ});return Array.isArray(t)?v:v[0]}Ve.preload=function(e,t,o){const s=Array.isArray(t)?t:[t];return wt(We(o),[e,...s])};Ve.clear=function(e,t){const o=Array.isArray(t)?t:[t];return bt([e,...o])};const K=new Map,{invalidate:Se,advance:ke}=qt(K),{reconciler:ae,applyProps:se}=zt(K,Lt),ee={objects:"shallow",strict:!1},Gt=(e,t)=>{const o=typeof e=="function"?e(t):e;return Ue(o)?o:new rt({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function $t(e,t){if(t)return t;if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:o,height:s,top:u,left:v}=e.parentElement.getBoundingClientRect();return{width:o,height:s,top:u,left:v}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function Wt(e){const t=K.get(e),o=t==null?void 0:t.fiber,s=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const u=typeof reportError=="function"?reportError:console.error,v=s||Bt(Se,ke),b=o||ae.createContainer(v,Y.exports.ConcurrentRoot,null,!1,null,"",u,null);t||K.set(e,{fiber:b,store:v});let m,i=!1;return{configure(p={}){let{gl:n,size:r,events:l,onCreated:d,shadows:f=!1,linear:_=!1,flat:y=!1,legacy:a=!1,orthographic:c=!1,frameloop:g="always",dpr:w=[1,2],performance:C,raycaster:k,camera:R,onPointerMissed:j}=p,S=v.getState(),x=S.gl;S.gl||S.set({gl:x=Gt(n,e)});let O=S.raycaster;O||S.set({raycaster:O=new Ye});const{params:L,...B}=k||{};if(D.equ(B,O,ee)||se(O,{...B}),D.equ(L,O.params,ee)||se(O,{params:{...O.params,...L}}),!S.camera){const h=R instanceof ot,P=h?R:c?new Ke(0,0,0,0,.1,1e3):new Je(75,0,.1,1e3);h||(P.position.z=5,R&&se(P,R),R!=null&&R.rotation||P.lookAt(0,0,0)),S.set({camera:P})}if(!S.xr){const h=(M,A)=>{const I=v.getState();I.frameloop!=="never"&&ke(M,!0,I,A)},P=()=>{const M=v.getState();M.gl.xr.enabled=M.gl.xr.isPresenting,M.gl.xr.setAnimationLoop(M.gl.xr.isPresenting?h:null),M.gl.xr.isPresenting||Se(M)},E={connect(){const M=v.getState().gl;M.xr.addEventListener("sessionstart",P),M.xr.addEventListener("sessionend",P)},disconnect(){const M=v.getState().gl;M.xr.removeEventListener("sessionstart",P),M.xr.removeEventListener("sessionend",P)}};x.xr&&E.connect(),S.set({xr:E})}if(x.shadowMap){const h=x.shadowMap.enabled,P=x.shadowMap.type;if(x.shadowMap.enabled=!!f,D.boo(f))x.shadowMap.type=le;else if(D.str(f)){var N;const E={basic:it,percentage:st,soft:le,variance:at};x.shadowMap.type=(N=E[f])!=null?N:le}else D.obj(f)&&Object.assign(x.shadowMap,f);(h!==x.shadowMap.enabled||P!==x.shadowMap.type)&&(x.shadowMap.needsUpdate=!0)}W&&("enabled"in W?W.enabled=!a:"legacyMode"in W&&(W.legacyMode=a));const G=_?lt:Te,U=y?ct:ut;x.outputEncoding!==G&&(x.outputEncoding=G),x.toneMapping!==U&&(x.toneMapping=U),S.legacy!==a&&S.set(()=>({legacy:a})),S.linear!==_&&S.set(()=>({linear:_})),S.flat!==y&&S.set(()=>({flat:y})),n&&!D.fun(n)&&!Ue(n)&&!D.equ(n,x,ee)&&se(x,n),l&&!S.events.handlers&&S.set({events:l(v)});const z=$t(e,r);return D.equ(z,S.size,ee)||S.setSize(z.width,z.height,z.updateStyle,z.top,z.left),w&&S.viewport.dpr!==ze(w)&&S.setDpr(w),S.frameloop!==g&&S.setFrameloop(g),S.onPointerMissed||S.set({onPointerMissed:j}),C&&!D.equ(C,S.performance,ee)&&S.set(h=>({performance:{...h.performance,...C}})),m=d,i=!0,this},render(p){return i||this.configure(),ae.updateContainer(F(Vt,{store:v,children:p,onCreated:m,rootElement:e}),b,null,()=>{}),v},unmount(){Xe(e)}}}function Vt({store:e,children:t,onCreated:o,rootElement:s}){return ne(()=>{const u=e.getState();u.set(v=>({internal:{...v.internal,active:!0}})),o&&o(u),e.getState().events.connected||u.events.connect==null||u.events.connect(s)},[]),T.exports.createElement(qe.Provider,{value:e},t)}function Xe(e,t){const o=K.get(e),s=o==null?void 0:o.fiber;if(s){const u=o==null?void 0:o.store.getState();u&&(u.internal.active=!1),ae.updateContainer(null,s,null,()=>{u&&setTimeout(()=>{try{var v,b,m,i;u.events.disconnect==null||u.events.disconnect(),(v=u.gl)==null||(b=v.renderLists)==null||b.dispose==null||b.dispose(),(m=u.gl)==null||m.forceContextLoss==null||m.forceContextLoss(),(i=u.gl)!=null&&i.xr&&u.xr.disconnect(),At(u),K.delete(e),t&&t(e)}catch{}},500)})}}ae.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:T.exports.version});const he={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Xt(e){const{handlePointer:t}=It(e);return{priority:1,enabled:!0,compute(o,s,u){s.pointer.set(o.offsetX/s.size.width*2-1,-(o.offsetY/s.size.height)*2+1),s.raycaster.setFromCamera(s.pointer,s.camera)},connected:void 0,handlers:Object.keys(he).reduce((o,s)=>({...o,[s]:t(s)}),{}),update:()=>{var o;const{events:s,internal:u}=e.getState();(o=u.lastEvent)!=null&&o.current&&s.handlers&&s.handlers.onPointerMove(u.lastEvent.current)},connect:o=>{var s;const{set:u,events:v}=e.getState();v.disconnect==null||v.disconnect(),u(b=>({events:{...b.events,connected:o}})),Object.entries((s=v.handlers)!=null?s:[]).forEach(([b,m])=>{const[i,p]=he[b];o.addEventListener(i,m,{passive:p})})},disconnect:()=>{const{set:o,events:s}=e.getState();if(s.connected){var u;Object.entries((u=s.handlers)!=null?u:[]).forEach(([v,b])=>{if(s&&s.connected instanceof HTMLElement){const[m]=he[v];s.connected.removeEventListener(m,b)}}),o(v=>({events:{...v.events,connected:void 0}}))}}}}const Yt=T.exports.forwardRef(function({children:t,fallback:o,resize:s,style:u,gl:v,events:b=Xt,eventSource:m,eventPrefix:i,shadows:p,linear:n,flat:r,legacy:l,orthographic:d,frameloop:f,dpr:_,performance:y,raycaster:a,camera:c,onPointerMissed:g,onCreated:w,...C},k){T.exports.useMemo(()=>Ne(ge),[]);const R=yt(),[j,S]=ht({scroll:!0,debounce:{scroll:50,resize:0},...s}),x=T.exports.useRef(null),O=T.exports.useRef(null),[L,B]=T.exports.useState(null);T.exports.useImperativeHandle(k,()=>x.current);const N=Le(g),[G,U]=T.exports.useState(!1),[z,h]=T.exports.useState(!1);if(G)throw G;if(z)throw z;const P=T.exports.useRef(null);return S.width>0&&S.height>0&&L&&(P.current||(P.current=Wt(L)),P.current.configure({gl:v,events:b,shadows:p,linear:n,flat:r,legacy:l,orthographic:d,frameloop:f,dpr:_,performance:y,raycaster:a,camera:c,size:S,onPointerMissed:(...M)=>N.current==null?void 0:N.current(...M),onCreated:M=>{M.events.connect==null||M.events.connect(m?Tt(m)?m.current:m:O.current),i&&M.setEvents({compute:(A,I)=>{const H=A[i+"X"],J=A[i+"Y"];I.pointer.set(H/I.size.width*2-1,-(J/I.size.height)*2+1),I.raycaster.setFromCamera(I.pointer,I.camera)}}),w==null||w(M)}}),P.current.render(F(R,{children:F(Fe,{set:h,children:F(T.exports.Suspense,{fallback:F(Ot,{set:U}),children:t})})}))),ne(()=>{B(x.current)},[]),T.exports.useEffect(()=>{if(L)return()=>Xe(L)},[L]),F("div",{ref:O,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:m?"none":"auto",...u},...C,children:F("div",{ref:j,style:{width:"100%",height:"100%"},children:F("canvas",{ref:x,style:{display:"block"},children:o})})})}),un=T.exports.forwardRef(function(t,o){return F(gt,{children:F(Yt,{...t,ref:o})})}),Kt=["string","number"],Jt=e=>{let t="";const o=[];return T.exports.Children.forEach(e,s=>{Kt.includes(typeof s)?t+=s+"":o.push(s)}),[t,...o]},fn=T.exports.forwardRef(({font:e,letterSpacing:t=0,lineHeight:o=1,size:s=1,height:u=.2,bevelThickness:v=.1,bevelSize:b=.01,bevelEnabled:m=!1,bevelOffset:i=0,bevelSegments:p=4,curveSegments:n=8,smooth:r,children:l,...d},f)=>{T.exports.useMemo(()=>Ne({RenamedTextGeometry:Ct}),[]);const _=T.exports.useRef(null),y=je(async()=>{let C=typeof e=="string"?await(await fetch(e)).json():e;return new Et().parse(C)},[e]),a=T.exports.useMemo(()=>({font:y,size:s,height:u,bevelThickness:v,bevelSize:b,bevelEnabled:m,bevelSegments:p,bevelOffset:i,curveSegments:n,letterSpacing:t,lineHeight:o}),[y,s,u,v,b,m,p,i,n,t,o]),[c,...g]=T.exports.useMemo(()=>Jt(l),[l]),w=T.exports.useMemo(()=>[c,a],[c,a]);return T.exports.useLayoutEffect(()=>{r&&(_.current.geometry=Pt(_.current.geometry,r),_.current.geometry.computeVertexNormals())},[w,r]),T.exports.useImperativeHandle(f,()=>_.current,[]),Re("mesh",{...d,ref:_,children:[F("renamedTextGeometry",{args:w}),g]})}),dn=T.exports.forwardRef(({makeDefault:e,camera:t,regress:o,domElement:s,enableDamping:u=!0,onChange:v,onStart:b,onEnd:m,...i},p)=>{const n=q(C=>C.invalidate),r=q(C=>C.camera),l=q(C=>C.gl),d=q(C=>C.events),f=q(C=>C.setEvents),_=q(C=>C.set),y=q(C=>C.get),a=q(C=>C.performance),c=t||r,g=s||d.connected||l.domElement,w=T.exports.useMemo(()=>new xt(c),[c]);return $e(()=>{w.enabled&&w.update()},-1),T.exports.useEffect(()=>(w.connect(g),()=>void w.dispose()),[g,o,w,n]),T.exports.useEffect(()=>{const C=j=>{n(),o&&a.regress(),v&&v(j)},k=j=>{b&&b(j)},R=j=>{m&&m(j)};return w.addEventListener("change",C),w.addEventListener("start",k),w.addEventListener("end",R),()=>{w.removeEventListener("start",k),w.removeEventListener("end",R),w.removeEventListener("change",C)}},[v,b,m,w,n,f]),T.exports.useEffect(()=>{if(e){const C=y().controls;return _({controls:w}),()=>_({controls:C})}},[e,w]),F("primitive",{ref:p,object:w,enableDamping:u,...i})}),pn=T.exports.forwardRef(({children:e,speed:t=1,rotationIntensity:o=1,floatIntensity:s=1,floatingRange:u=[-.1,.1],...v},b)=>{const m=T.exports.useRef(null),i=T.exports.useRef(Math.random()*1e4);return $e(p=>{var n,r;const l=i.current+p.clock.getElapsedTime();m.current.rotation.x=Math.cos(l/4*t)/8*o,m.current.rotation.y=Math.sin(l/4*t)/8*o,m.current.rotation.z=Math.sin(l/4*t)/20*o;let d=Math.sin(l/4*t)/10;d=vt.mapLinear(d,-.1,.1,(n=u==null?void 0:u[0])!==null&&n!==void 0?n:-.1,(r=u==null?void 0:u[1])!==null&&r!==void 0?r:.1),m.current.position.y=d*s}),F("group",{...v,children:F("group",{ref:Mt([m,b]),children:e})})}),vn=T.exports.forwardRef(({fog:e=!1,renderOrder:t,depthWrite:o=!1,colorStop:s=0,color:u="black",opacity:v=.5,...b},m)=>{const i=T.exports.useMemo(()=>{const p=document.createElement("canvas");p.width=128,p.height=128;const n=p.getContext("2d"),r=n.createRadialGradient(p.width/2,p.height/2,0,p.width/2,p.height/2,p.width/2);return r.addColorStop(s,new Oe(u).getStyle()),r.addColorStop(1,"rgba(0,0,0,0)"),n.fillStyle=r,n.fillRect(0,0,p.width,p.height),p},[u,s]);return Re("mesh",{renderOrder:t,ref:m,"rotation-x":-Math.PI/2,...b,children:[F("planeGeometry",{}),F("meshBasicMaterial",{transparent:!0,opacity:v,fog:e,depthWrite:o,side:mt,children:F("canvasTexture",{attach:"map",args:[i]})})]})});export{un as C,pn as F,dn as O,vn as S,fn as T,Ve as u};
